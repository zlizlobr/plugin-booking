{"version":3,"file":"assets_js_admin_wpify_blocks_ProductList_js.js","mappings":"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","sources":["webpack://Booking/./assets/js/admin/wpify/blocks/ProductList.js"],"sourcesContent":["import React from 'react';\nimport { render } from 'react-dom';\nimport TableBuilderComponent from '../../TableBuilderComponent.jsx';\n\n// Kontrolní konstanta pro zabránění opakovaného renderování\nlet productListInitialized = false;\n\nconst renderTableBuilderComponent = (container) => {\n  try {\n    // Get data from data attribute\n    const initialDataAttr = container.getAttribute('data-initial-data');\n    let initialData = null;\n    \n    if (initialDataAttr && initialDataAttr.trim()) {\n      try {\n        // Clean the data attribute value - remove any HTML tags or extra content\n        const cleanData = initialDataAttr.replace(/<[^>]*>/g, '').trim();\n        initialData = JSON.parse(cleanData);\n      } catch (e) {\n        console.warn('Failed to parse initial table data:', e);\n        console.warn('Raw data attribute value:', initialDataAttr);\n        // Use default data if parsing fails\n        initialData = null;\n      }\n    }\n    \n    // Handle data changes\n    const handleDataChange = (newData) => {\n      const hiddenInput = document.getElementById('wpcbooking-table-data-input');\n      if (hiddenInput) {\n        hiddenInput.value = JSON.stringify(newData);\n      }\n    };\n    \n    // Render the component\n    render(\n      <TableBuilderComponent\n        initialData={initialData}\n        onDataChange={handleDataChange}\n      />, \n      container\n    );\n\n    // Označit kontejner jako renderovaný\n    container.setAttribute(\"data-rendered\", \"true\");\n  } catch (error) {\n    console.error(\"Error rendering Table Builder component:\", error);\n  }\n};\n\nexport const initializeProductList = () => {\n  if (productListInitialized) {\n    return;\n  }\n\n  const tableBuilderContainers = document.querySelectorAll('#table-builder-container');\n\n  if (tableBuilderContainers.length > 0) {\n    tableBuilderContainers.forEach((container) => {\n      // Zkontrolovat, zda už není renderovaný\n      if (!container.getAttribute(\"data-rendered\")) {\n        renderTableBuilderComponent(container);\n      }\n    });\n    productListInitialized = true;\n  }\n\n  // Setup event listeners for popup controls\n  const initProductListControls = () => {\n    const triggers = document.querySelectorAll('[data-wpcbooking-table-builder-trigger]');\n    \n    triggers.forEach((trigger) => {\n      const popup = trigger.closest('.wpcbooking-price-table-builder')?.querySelector('[data-wpcbooking-table-builder-popup]');\n      if (!popup) return;\n\n      const overlay = popup.querySelector('[data-wpcbooking-table-builder-overlay]');\n      const closeButtons = popup.querySelectorAll('[data-wpcbooking-table-builder-close], [data-wpcbooking-table-builder-cancel]');\n      const saveButton = popup.querySelector('[data-wpcbooking-table-builder-save]');\n      const container = popup.querySelector('#table-builder-container');\n      const hiddenInput = document.getElementById('wpcbooking-table-data-input');\n      \n      const openPopup = () => {\n        popup.classList.remove('hidden');\n        document.body.style.overflow = 'hidden';\n        \n        // Initialize table component when popup opens\n        if (container && !container.getAttribute(\"data-rendered\")) {\n          renderTableBuilderComponent(container);\n        }\n      };\n\n      const closePopup = () => {\n        popup.classList.add('hidden');\n        document.body.style.overflow = '';\n      };\n      \n      const savePopup = () => {\n        // Data is already saved in hidden input via TableBuilderComponent\n        // Just close the popup\n        closePopup();\n      };\n\n      trigger.addEventListener('click', () => openPopup());\n      closeButtons.forEach((button) => button.addEventListener('click', () => closePopup()));\n      if (overlay) overlay.addEventListener('click', () => closePopup());\n      if (saveButton) saveButton.addEventListener('click', () => savePopup());\n    });\n  };\n\n  // Initialize controls\n  initProductListControls();\n\n  // Setup observer for dynamic content\n  const observer = new MutationObserver((mutations) => {\n    mutations.forEach((mutation) => {\n      if (mutation.type === \"childList\") {\n        mutation.addedNodes.forEach((node) => {\n          if (node.nodeType === Node.ELEMENT_NODE) {\n            // Zkontrolovat, zda přidaný element obsahuje table-builder-container\n            const tableBuilderContainer =\n              node.id === \"table-builder-container\"\n                ? node\n                : node.querySelector(\"#table-builder-container\");\n\n            if (\n              tableBuilderContainer &&\n              !tableBuilderContainer.getAttribute(\"data-rendered\")\n            ) {\n              renderTableBuilderComponent(tableBuilderContainer);\n            }\n\n            // Re-initialize controls for new popup elements\n            if (node.querySelector('[data-wpcbooking-table-builder-trigger]')) {\n              initProductListControls();\n            }\n          }\n        });\n      }\n    });\n  });\n\n  // Sledovat změny v celém dokumentu\n  observer.observe(document.body, {\n    childList: true,\n    subtree: true,\n  });\n\n  // Cleanup po 30 sekundách\n  setTimeout(() => {\n    observer.disconnect();\n  }, 30000);\n};\n\n// Auto-initialize when DOM is ready\nif (document.readyState === 'loading') {\n  document.addEventListener('DOMContentLoaded', initializeProductList);\n} else {\n  initializeProductList();\n}\n"],"names":["React","render","TableBuilderComponent","productListInitialized","renderTableBuilderComponent","container","initialDataAttr","getAttribute","initialData","trim","cleanData","replace","JSON","parse","e","console","warn","handleDataChange","newData","hiddenInput","document","getElementById","value","stringify","h","onDataChange","setAttribute","error","initializeProductList","tableBuilderContainers","querySelectorAll","length","forEach","initProductListControls","triggers","trigger","_trigger$closest","popup","closest","querySelector","overlay","closeButtons","saveButton","openPopup","classList","remove","body","style","overflow","closePopup","add","savePopup","addEventListener","button","observer","MutationObserver","mutations","mutation","type","addedNodes","node","nodeType","Node","ELEMENT_NODE","tableBuilderContainer","id","observe","childList","subtree","setTimeout","disconnect","readyState"],"sourceRoot":""}